from selenium import webdriver
import sys
import os
import time


def get_website_title(url, wd):
    # Open the website
    wd.get(url)

    # Get the title of the website
    title = wd.title
    print("Title:", title)
    
    # Wait for 5 seconds
    time.sleep(5)


c = 0

def screenshot():
    # Access the global variable c
    global c
    
    # Save screenshot with custom path and filename
    wd.save_screenshot(f"/content/screenshot{c}.png")

    # Increment c
    c += 1

    time.sleep(5)



def click():
    from selenium.webdriver.common.by import By
    from selenium.webdriver.support.ui import WebDriverWait
    from selenium.webdriver.support import expected_conditions as EC

    # Wait for the button to be clickable
    button = WebDriverWait(wd, 10).until(EC.element_to_be_clickable((By.ID, "rcc-confirm-button")))

    # Click the button
    button.click()
    time.sleep(5)
    c2()

def c2():
    # Scroll down 10 pixels
    wd.execute_script("window.scrollBy(0, 500);")
    time.sleep(5)
    c3()

def c3():
    from selenium.webdriver.common.action_chains import ActionChains

    # Get the x and y coordinates
    x = 100
    y = 400

    # Perform a click action at the specified coordinates
    ActionChains(wd).move_by_offset(x, y).click().perform()
    time.sleep(5)


def count():
    import requests
    
    # Download the file from GitHub
    url = 'https://raw.githubusercontent.com/ameenTheprogramer/imgcount/main/count.txt'
    response = requests.get(url)
    if response.status_code == 200:
        value = int(response.text.strip())  # Convert the text to an integer
    else:
        print("Failed to download the file")
    
    # Assign the value to a constant variable
    k = value
    
    # Verify the constant value
    print("Constant value:", k)

    return k





def script():
    from selenium.webdriver.common.keys import Keys
    
    # Number of times to press the right arrow key
    total_presses = k
    
    # Perform the action
    for _ in range(total_presses):
        # Simulate pressing the right arrow key
        wd.find_element(By.TAG_NAME, 'body').send_keys(Keys.ARROW_RIGHT)
        # Wait for 5 seconds
        time.sleep(5)
        print(_)
    

def kill():
    

    # Disconnect the runtime
    os.kill(os.getpid(), 9)

    # Delete the runtime
    !kill -9 -1


def setup():
    # Install Selenium
    !pip install selenium
    
    # Update apt-get
    !apt-get update
    
    # Install Chromium and Chromedriver
    !apt install chromium-chromedriver
    !cp /usr/lib/chromium-browser/chromedriver /usr/bin
    
    # Add Chromedriver path to system path
    sys.path.insert(0,'/usr/lib/chromium-browser/chromedriver')
    
    # Import webdriver and set Chrome options
    from selenium import webdriver
    chrome_options = webdriver.ChromeOptions()
    chrome_options.add_argument('--headless')
    chrome_options.add_argument('--no-sandbox')
    chrome_options.add_argument('--disable-dev-shm-usage')
    
    # Initialize webdriver and return the wd object
    wd = webdriver.Chrome(options=chrome_options)
    
    return wd

# To use the setup function:
# To use the function:
wd = setup()  # Assuming you have already defined the 'setup' function
get_website_title("https://www.clickasnap.com/iamthecoolguy", wd)
screenshot()
k = count()
click()
screenshot()
script()
screenshot()

